FROM node:20-bookworm-slim

WORKDIR /app

COPY front/package.json front/package-lock.json* front/pnpm-lock.yaml* front/yarn.lock* ./
RUN npm install

COPY front . .

# Vari√°veis de ambiente para build do Next.js
ARG NEXT_PUBLIC_API_URL=http://localhost:3000
ARG NEXT_PUBLIC_ABLY_KEY

ENV NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL}
ENV NEXT_PUBLIC_ABLY_KEY=${NEXT_PUBLIC_ABLY_KEY}
ENV NEXT_TELEMETRY_DISABLED=1

EXPOSE 3000

CMD ["npm", "run", "dev"]
